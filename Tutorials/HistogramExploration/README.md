# Histogram Exploration Tutorial

Histogram ì´í•´ë¥¼ ìœ„í•œ ë‹¨ê³„ë³„ ì˜ˆì œ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ì´ˆë³´ìë¶€í„° ê³ ê¸‰ ìˆ˜ì¤€ê¹Œì§€ì˜ ì˜ˆì œë¥¼ í¬í•¨í•˜ë©°, Microsoft Learn ë¬¸ì„œì™€ Functorium ì½”ë“œë² ì´ìŠ¤ì˜ ì‹¤ì œ êµ¬í˜„ì„ ì°¸ê³ í•©ë‹ˆë‹¤.

## ğŸ“š í•™ìŠµ ëª©í‘œ

1. **Histogram ê¸°ë³¸ ê°œë…**: ë¶„í¬ ì¸¡ì •, ë°±ë¶„ìœ„ìˆ˜
2. **ë°±ë¶„ìœ„ìˆ˜ ì´í•´**: P50, P95, P99ì˜ ì˜ë¯¸ì™€ í™œìš© (Basic04)
3. **ë²„í‚· ì „ëµ**: ê¸°ë³¸ ë²„í‚· vs ì»¤ìŠ¤í…€ ë²„í‚·
4. **SLO ì •ë ¬**: ëª©í‘œê°’ê³¼ ë²„í‚· ê²½ê³„ ì •ë ¬ì˜ ì¤‘ìš”ì„±
5. **ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­**: ë©”ëª¨ë¦¬ ì‚¬ìš©, íƒœê·¸ ì¹´ë””ë„ë¦¬í‹°
6. **ì‹¤ì „ ì ìš©**: ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œì˜ í™œìš© ë°©ë²•

## ğŸ“Š ë°±ë¶„ìœ„ìˆ˜(Percentile) ì´í•´

### ë°±ë¶„ìœ„ìˆ˜ë€?

ë°±ë¶„ìœ„ìˆ˜ëŠ” ë°ì´í„° ì§‘í•©ì—ì„œ íŠ¹ì • ë¹„ìœ¨ì˜ ê°’ì´ ê·¸ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ ê°’ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

**ì£¼ìš” ë°±ë¶„ìœ„ìˆ˜:**
- **P50 (ì¤‘ì•™ê°’)**: 50%ì˜ ê°’ì´ ì´ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìŒ
- **P90**: 90%ì˜ ê°’ì´ ì´ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìŒ
- **P95**: 95%ì˜ ê°’ì´ ì´ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìŒ
- **P99**: 99%ì˜ ê°’ì´ ì´ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìŒ

### ë°±ë¶„ìœ„ìˆ˜ ê°’ì˜ ì˜ë¯¸

ê° ë°±ë¶„ìœ„ìˆ˜ ê°’ì´ ì‹¤ì œë¡œ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ êµ¬ì²´ì ìœ¼ë¡œ ì´í•´í•´ë´…ì‹œë‹¤.

#### P50 (ì¤‘ì•™ê°’, Median)

**ì˜ë¯¸**: ë°ì´í„°ë¥¼ ì •ë ¬í–ˆì„ ë•Œ ì •í™•íˆ ì¤‘ê°„ì— ìˆëŠ” ê°’

**ì˜ˆì‹œ**: P50 = 200ms
- 100ê°œ ìš”ì²­ ì¤‘ 50ê°œëŠ” 200ms ì´í•˜
- 100ê°œ ìš”ì²­ ì¤‘ 50ê°œëŠ” 200ms ì´ìƒ
- "ì ˆë°˜ì˜ ìš”ì²­ì€ ë¹ ë¥´ê³ , ì ˆë°˜ì€ ëŠë¦¬ë‹¤"ëŠ” ì˜ë¯¸

**í™œìš©**:
- ì „ì²´ ì„±ëŠ¥ì˜ ëŒ€í‘œê°’ìœ¼ë¡œ ì‚¬ìš©
- í‰ê· ê°’ë³´ë‹¤ ì´ìƒì¹˜(outlier)ì˜ ì˜í–¥ì„ ëœ ë°›ìŒ
- ì¼ë°˜ì ì¸ ì‚¬ìš©ì ê²½í—˜ì„ ë‚˜íƒ€ëƒ„

#### P90

**ì˜ë¯¸**: 90%ì˜ ìš”ì²­ì´ ì´ ê°’ ì´í•˜

**ì˜ˆì‹œ**: P90 = 900ms
- 100ê°œ ìš”ì²­ ì¤‘ 90ê°œëŠ” 900ms ì´í•˜
- 100ê°œ ìš”ì²­ ì¤‘ 10ê°œë§Œ 900ms ì´ˆê³¼
- "ëŒ€ë¶€ë¶„ì˜ ìš”ì²­ì€ ë¹ ë¥´ì§€ë§Œ, ì¼ë¶€ëŠ” ëŠë¦¬ë‹¤"

**í™œìš©**:
- ì¼ë°˜ì ì¸ ì„±ëŠ¥ ëª©í‘œ ì„¤ì •
- ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ì ê²½í—˜ì„ ë‚˜íƒ€ëƒ„
- SLO ì„¤ì •ì— ìì£¼ ì‚¬ìš©ë¨

#### P95

**ì˜ë¯¸**: 95%ì˜ ìš”ì²­ì´ ì´ ê°’ ì´í•˜

**ì˜ˆì‹œ**: P95 = 2000ms
- 100ê°œ ìš”ì²­ ì¤‘ 95ê°œëŠ” 2000ms ì´í•˜
- 100ê°œ ìš”ì²­ ì¤‘ 5ê°œë§Œ 2000ms ì´ˆê³¼
- "ê±°ì˜ ëª¨ë“  ìš”ì²­ì€ ë¹ ë¥´ì§€ë§Œ, ê·¹ì†Œìˆ˜ëŠ” ë§¤ìš° ëŠë¦¬ë‹¤"

**í™œìš©**:
- **ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°±ë¶„ìœ„ìˆ˜**
- SLO ì„¤ì •ì˜ í‘œì¤€ (ì˜ˆ: P95 â‰¤ 500ms)
- ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ì ê²½í—˜ì„ ë‚˜íƒ€ëƒ„
- Tail latency (ê¼¬ë¦¬ ì§€ì—°ì‹œê°„) ë¶„ì„ì— ì¤‘ìš”

**ì™œ P95ë¥¼ ë§ì´ ì‚¬ìš©í•˜ë‚˜?**
- P50ì€ ë„ˆë¬´ ë‚™ê´€ì  (ì ˆë°˜ë§Œ ê³ ë ¤)
- P99ëŠ” ë„ˆë¬´ ë³´ìˆ˜ì  (ê·¹ë‹¨ì ì¸ ê²½ìš°ê¹Œì§€ ê³ ë ¤)
- P95ëŠ” ê· í˜•ì¡íŒ ì§€í‘œ (ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ì + ì¼ë¶€ ì˜ˆì™¸ ê³ ë ¤)

#### P99

**ì˜ë¯¸**: 99%ì˜ ìš”ì²­ì´ ì´ ê°’ ì´í•˜

**ì˜ˆì‹œ**: P99 = 4640ms (10ê°œ ìš”ì²­ ê¸°ì¤€)
- 10ê°œ ìš”ì²­ ì¤‘ 9.9ê°œëŠ” 4640ms ì´í•˜
- 10ê°œ ìš”ì²­ ì¤‘ 0.1ê°œë§Œ 4640ms ì´ˆê³¼
- "ê±°ì˜ ëª¨ë“  ìš”ì²­ì€ ë¹ ë¥´ì§€ë§Œ, ê·¹íˆ ì¼ë¶€ëŠ” ë§¤ìš° ëŠë¦¬ë‹¤"
- ì‹¤ì œ ë°ì´í„°: [100, 120, 150, 180, 200, 250, 300, 500, 1000, 5000]ì—ì„œ ê±°ì˜ 10ë²ˆì§¸ ê°’(5000ms)ì— ê°€ê¹Œì›€

**í™œìš©**:
- ìµœì•…ì˜ ê²½ìš°ë¥¼ ì œì™¸í•œ ì„±ëŠ¥ ë¶„ì„
- ì¸í”„ë¼ ìš©ëŸ‰ ê³„íš (ìµœì•…ì˜ ê²½ìš° ëŒ€ë¹„)
- ì‚¬ìš©ì ë¶ˆë§Œ ìµœì†Œí™” ëª©í‘œ
- Critical ì„œë¹„ìŠ¤ì˜ ì—„ê²©í•œ SLO ì„¤ì •

**ì£¼ì˜ì‚¬í•­**:
- P99ëŠ” ê·¹ë‹¨ì ì¸ ê°’ì— ë¯¼ê°í•¨
- ì¼ë¶€ ì´ìƒì¹˜ê°€ ì „ì²´ ë¶„í¬ë¥¼ ì™œê³¡í•  ìˆ˜ ìˆìŒ
- P99.9, P99.99 ë“± ë” ë†’ì€ ë°±ë¶„ìœ„ìˆ˜ë„ ì‚¬ìš© ê°€ëŠ¥

#### ë°±ë¶„ìœ„ìˆ˜ ë¹„êµ ì˜ˆì‹œ

**ì‹œë‚˜ë¦¬ì˜¤**: API ì‘ë‹µ ì‹œê°„ ì¸¡ì • ê²°ê³¼

| ë°±ë¶„ìœ„ìˆ˜ | ê°’ | í•´ì„ |
|---------|-----|------|
| **P50** | 150ms | ì ˆë°˜ì˜ ì‚¬ìš©ìëŠ” 150ms ì´ë‚´ ì‘ë‹µ ë°›ìŒ âœ… |
| **P90** | 300ms | 90%ì˜ ì‚¬ìš©ìëŠ” 300ms ì´ë‚´ ì‘ë‹µ ë°›ìŒ âœ… |
| **P95** | 500ms | 95%ì˜ ì‚¬ìš©ìëŠ” 500ms ì´ë‚´ ì‘ë‹µ ë°›ìŒ âœ… |
| **P99** | 2000ms | 99%ì˜ ì‚¬ìš©ìëŠ” 2ì´ˆ ì´ë‚´ ì‘ë‹µ ë°›ìŒ âš ï¸ |
| **í‰ê· ** | 250ms | ì „ì²´ í‰ê· ì€ ë¹ ë¥´ì§€ë§Œ... |

**ë¶„ì„**:
- P50~P95ëŠ” ëª¨ë‘ ì–‘í˜¸í•œ ìˆ˜ì¤€ (500ms ì´í•˜)
- í•˜ì§€ë§Œ P99ê°€ 2000msë¡œ ë†’ìŒ
- â†’ ê·¹ì†Œìˆ˜ì˜ ìš”ì²­ì´ ë§¤ìš° ëŠë¦¼ (1% = 100ê°œ ì¤‘ 1ê°œ)
- â†’ ì´ 1%ì˜ ìš”ì²­ì´ ì‚¬ìš©ì ë¶ˆë§Œì˜ ì›ì¸ì¼ ìˆ˜ ìˆìŒ

**ì¡°ì¹˜**:
- P99ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ëŠë¦° ìš”ì²­ì˜ ì›ì¸ ì¡°ì‚¬ í•„ìš”
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”, ìºì‹œ ì¶”ê°€ ë“±
- ëª©í‘œ: P99ë¥¼ 2000ms â†’ 1000msë¡œ ê°œì„ 

### ì™œ ë°±ë¶„ìœ„ìˆ˜ê°€ ì¤‘ìš”í•œê°€?

í‰ê· ê°’ë§Œìœ¼ë¡œëŠ” ì „ì²´ ë¶„í¬ë¥¼ ì´í•´í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤:

```
í‰ê· : 100ms
í•˜ì§€ë§Œ ì¼ë¶€ ìš”ì²­ì€ 1000ms ì´ìƒ ê±¸ë¦´ ìˆ˜ ìˆìŒ
â†’ P95ë¥¼ ë³´ë©´ 'ëŒ€ë¶€ë¶„ì˜ ìš”ì²­'ì´ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŒ
```

### êµ¬ì²´ì ì¸ ì˜ˆì œ

**ì‹œë‚˜ë¦¬ì˜¤**: 100ê°œì˜ HTTP ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ì„ ì¸¡ì •í–ˆìŠµë‹ˆë‹¤.

**ì¸¡ì •ê°’ ì˜ˆì‹œ** (ë°€ë¦¬ì´ˆ):
```
[50, 52, 55, 58, 60, 62, 65, 68, 70, 72, 75, 78, 80, 82, 85, 88, 90, 92, 95, 98,
 100, 105, 110, 115, 120, 125, 130, 135, 140, 145, 150, 155, 160, 165, 170, 175,
 180, 185, 190, 195, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 320,
 340, 360, 380, 400, 420, 440, 460, 480, 500, 550, 600, 650, 700, 750, 800, 850,
 900, 950, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000,
 2200, 2400, 2600, 2800, 3000, 3500, 4000, 4500, 5000, 6000, 7000, 8000, 9000, 10000]
```

**ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚° ê²°ê³¼**:

| ë°±ë¶„ìœ„ìˆ˜ | ê°’ | ì˜ë¯¸ |
|---------|-----|------|
| **P50 (ì¤‘ì•™ê°’)** | 200ms | ì ˆë°˜ì˜ ìš”ì²­(50ê°œ)ì´ 200ms ì´ë‚´ì— ì™„ë£Œë¨ |
| **P90** | 900ms | 90%ì˜ ìš”ì²­(90ê°œ)ì´ 900ms ì´ë‚´ì— ì™„ë£Œë¨ |
| **P95** | 2000ms | 95%ì˜ ìš”ì²­(95ê°œ)ì´ 2000ms ì´ë‚´ì— ì™„ë£Œë¨ |
| **P99** | 7000ms | 99%ì˜ ìš”ì²­(99ê°œ)ì´ 7000ms ì´ë‚´ì— ì™„ë£Œë¨ |
| **í‰ê· ** | 1,050ms | ëª¨ë“  ìš”ì²­ì˜ í‰ê·  ì²˜ë¦¬ ì‹œê°„ |

**í•´ì„**:
- **í‰ê· ê°’(1,050ms)**: ëª¨ë“  ìš”ì²­ì˜ í‰ê·  â†’ "ì „ì²´ì ìœ¼ë¡œ ëŠë¦¬ë‹¤"ê³  ì˜¤í•´í•  ìˆ˜ ìˆìŒ
- **P50(200ms)**: ì ˆë°˜ì˜ ìš”ì²­ì´ 200ms ì´ë‚´ â†’ "ëŒ€ë¶€ë¶„ì˜ ìš”ì²­ì€ ë¹ ë¥´ë‹¤"
- **P90(900ms)**: 90%ì˜ ìš”ì²­ì´ 900ms ì´ë‚´ â†’ "ê±°ì˜ ëª¨ë“  ìš”ì²­ì€ ë¹ ë¥´ë‹¤"
- **P95(2000ms)**: 95%ì˜ ìš”ì²­ì´ 2ì´ˆ ì´ë‚´ â†’ "ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ìëŠ” 2ì´ˆ ì´ë‚´ ì‘ë‹µ"
- **P99(7000ms)**: 99%ì˜ ìš”ì²­ì´ 7ì´ˆ ì´ë‚´ â†’ "ê·¹ì†Œìˆ˜ì˜ ìš”ì²­(1%)ë§Œ ë§¤ìš° ëŠë¦¬ë‹¤"

**í•µì‹¬ ì¸ì‚¬ì´íŠ¸**:
- í‰ê· ê°’ì€ ëŠë¦° ìš”ì²­(ê·¹ë‹¨ê°’)ì— ì˜í•´ ì™œê³¡ë¨
- P50ì€ "ì¼ë°˜ì ì¸" ì„±ëŠ¥ì„ ë³´ì—¬ì¤Œ
- P95ëŠ” "ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ì"ê°€ ê²½í—˜í•˜ëŠ” ì„±ëŠ¥
- P99ëŠ” "ê±°ì˜ ëª¨ë“  ì‚¬ìš©ì"ê°€ ê²½í—˜í•˜ëŠ” ì„±ëŠ¥ (ê·¹ë‹¨ ì œì™¸)

**SLO ì„¤ì • ì˜ˆì‹œ**:
```
SLO ëª©í‘œ: P95 â‰¤ 500ms
í˜„ì¬ P95: 2000ms
â†’ SLO ìœ„ë°˜! (2000ms > 500ms)
â†’ ì„±ëŠ¥ ìµœì í™”ê°€ í•„ìš”í•¨
```

**ì„±ëŠ¥ ê°œì„  í›„**:
```
ê°œì„  ì „: P95 = 2000ms
ê°œì„  í›„: P95 = 450ms
â†’ SLO ë‹¬ì„±! (450ms â‰¤ 500ms)
```

### Histogramê³¼ ë°±ë¶„ìœ„ìˆ˜ì˜ ê´€ê³„

1. **Histogramì— ì¸¡ì •ê°’ ê¸°ë¡**: ê° ìš”ì²­ì˜ ì²˜ë¦¬ ì‹œê°„ì„ ê¸°ë¡
2. **ë²„í‚·ìœ¼ë¡œ ì§‘ê³„**: ê°’ë“¤ì„ ë²„í‚· ë‹¨ìœ„ë¡œ ê·¸ë£¹í™”
3. **ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚°**: ë²„í‚· ë¶„í¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚°

**ì˜ˆì‹œ: ë²„í‚· ë¶„í¬ì™€ ë°±ë¶„ìœ„ìˆ˜**

ì¸¡ì •ê°’: `[100, 120, 150, 180, 200, 250, 300, 500, 1000, 5000]` ms

ë²„í‚· ê²½ê³„: `[0.1s, 0.25s, 0.5s, 1s, 2.5s, 5s]` (ì´ˆ ë‹¨ìœ„)

ì¸¡ì •ê°’ì„ ë²„í‚·ìœ¼ë¡œ ë¶„ë¥˜:
```
[0s - 0.1s):    0ê°œ ìš”ì²­ (0%)   - ì—†ìŒ
[0.1s - 0.25s): 4ê°œ ìš”ì²­ (40%)  - 100ms, 120ms, 150ms, 180ms
[0.25s - 0.5s): 3ê°œ ìš”ì²­ (30%)  - 200ms, 250ms, 300ms
[0.5s - 1s):    1ê°œ ìš”ì²­ (10%)  - 500ms
[1s - 2.5s):    1ê°œ ìš”ì²­ (10%)  - 1000ms
[2.5s - 5s):    0ê°œ ìš”ì²­ (0%)   - ì—†ìŒ
[5s ì´ìƒ]:       1ê°œ ìš”ì²­ (10%)  - 5000ms
```

ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚°:
- **P50**: 40% (0.1s-0.25s ë²„í‚·)ë§Œìœ¼ë¡œëŠ” ë¶€ì¡± â†’ ë‹¤ìŒ ë²„í‚·(0.25s-0.5s)ì—ì„œ ì¶”ê°€ë¡œ 10% í•„ìš” â†’ `0.25s` ë²„í‚· ë‚´ë¶€ì˜ íŠ¹ì • ê°’
- **P90**: 40% + 30% + 10% = 80% â†’ ë‹¤ìŒ ë²„í‚·(0.5s-1s)ì—ì„œ ì¶”ê°€ë¡œ 10% í•„ìš” â†’ `0.5s` ë²„í‚· ë‚´ë¶€
- **P95**: 40% + 30% + 10% + 10% = 90% â†’ ë‹¤ìŒ ë²„í‚·(1s-2.5s)ì—ì„œ ì¶”ê°€ë¡œ 5% í•„ìš” â†’ `1s` ë²„í‚· ë‚´ë¶€
- **P99**: ê±°ì˜ ëª¨ë“  ìš”ì²­ í¬í•¨ â†’ `2.5s` ë²„í‚· ë˜ëŠ” ê·¸ ì´ìƒ

**ì§ê´€ì  ì´í•´**:
- 10ê°œ ìš”ì²­ ì¤‘ 4ê°œëŠ” ë¹ ë¦„ (100-180ms)
- 10ê°œ ìš”ì²­ ì¤‘ 3ê°œëŠ” ë³´í†µ (200-300ms)
- 10ê°œ ìš”ì²­ ì¤‘ 2ê°œëŠ” ëŠë¦¼ (500-1000ms)
- 10ê°œ ìš”ì²­ ì¤‘ 1ê°œëŠ” ë§¤ìš° ëŠë¦¼ (5000ms)
- â†’ ì´ 1ê°œì˜ ë§¤ìš° ëŠë¦° ìš”ì²­ì´ í‰ê· ê°’ì„ ì™œê³¡ì‹œí‚´

### ì‹¤ì „ í™œìš© ì˜ˆì œ

#### 1. SLO ì„¤ì • ë° ëª¨ë‹ˆí„°ë§

**ì‹œë‚˜ë¦¬ì˜¤**: API ì„œë¹„ìŠ¤ì˜ ì‘ë‹µ ì‹œê°„ SLO ì„¤ì •

```yaml
SLO ëª©í‘œ:
  - P95 â‰¤ 500ms  # 95%ì˜ ìš”ì²­ì´ 500ms ì´ë‚´
  - P99 â‰¤ 1000ms # 99%ì˜ ìš”ì²­ì´ 1ì´ˆ ì´ë‚´
```

**ëª¨ë‹ˆí„°ë§ ì¿¼ë¦¬** (Prometheus ì˜ˆì‹œ):
```promql
# P95 ê³„ì‚°
histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))

# P99 ê³„ì‚°
histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m]))

# SLO ìœ„ë°˜ ì•Œë¦¼
histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m])) > 0.5
```

#### 2. ì„±ëŠ¥ ì €í•˜ ê°ì§€

**ì‹œë‚˜ë¦¬ì˜¤**: ì‹œê°„ì— ë”°ë¥¸ P95 ì¶”ì´ ê´€ì°°

```
ì‹œê°„ëŒ€ë³„ P95 ê°’:
09:00 - P95: 200ms âœ… (ì •ìƒ)
10:00 - P95: 250ms âœ… (ì •ìƒ)
11:00 - P95: 450ms âš ï¸  (ì£¼ì˜)
12:00 - P95: 600ms âŒ (SLO ìœ„ë°˜!)
13:00 - P95: 550ms âŒ (ì—¬ì „íˆ ìœ„ë°˜)
14:00 - P95: 300ms âœ… (ë³µêµ¬ë¨)
```

**ë¶„ì„**: 11ì‹œ~13ì‹œ ì‚¬ì´ì— ì„±ëŠ¥ ì €í•˜ ë°œìƒ â†’ ì›ì¸ ì¡°ì‚¬ í•„ìš”

#### 3. ìš©ëŸ‰ ê³„íš

**ì‹œë‚˜ë¦¬ì˜¤**: ì¸í”„ë¼ ìš©ëŸ‰ ê²°ì •

```
í˜„ì¬ ìƒíƒœ:
- í‰ê·  RPS: 1000 req/s
- P99: 2000ms
- ëª©í‘œ: P99 â‰¤ 500ms

ê³„ì‚°:
- í˜„ì¬ ì²˜ë¦¬ ìš©ëŸ‰: 1000 req/s
- P99ê°€ 4ë°° ê°œì„  í•„ìš” (2000ms â†’ 500ms)
- ì˜ˆìƒ í•„ìš” ìš©ëŸ‰: 4000 req/s

â†’ ì¸í”„ë¼ë¥¼ 4ë°° í™•ì¥ í•„ìš”
```

#### 4. ì‚¬ìš©ì ê²½í—˜ ë¶„ì„

**ì‹œë‚˜ë¦¬ì˜¤**: ì‚¬ìš©ìê°€ ê²½í—˜í•˜ëŠ” ì‹¤ì œ ì„±ëŠ¥

```
í‰ê·  ì‘ë‹µ ì‹œê°„: 500ms
P50 (ì¤‘ì•™ê°’): 200ms
P95: 1500ms
P99: 3000ms

í•´ì„:
- í‰ê· (500ms)ì€ "ì „ì²´ì ìœ¼ë¡œ ëŠë¦¬ë‹¤"ê³  ë³´ì´ì§€ë§Œ
- P50(200ms)ì€ "ì ˆë°˜ì˜ ì‚¬ìš©ìëŠ” ë¹ ë¥¸ ì‘ë‹µì„ ë°›ëŠ”ë‹¤"
- P95(1500ms)ëŠ” "ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ì(95%)ëŠ” 1.5ì´ˆ ì´ë‚´ ì‘ë‹µ"
- P99(3000ms)ëŠ” "ê·¹ì†Œìˆ˜ ì‚¬ìš©ìë§Œ 3ì´ˆ ì´ìƒ ëŒ€ê¸°"

â†’ P95ê°€ ì‚¬ìš©ì ê²½í—˜ì„ ë” ì˜ ë‚˜íƒ€ëƒ„
```

**ì˜ˆì œ ì‹¤í–‰:**
```bash
dotnet run -- 4  # Basic04: Understanding Percentiles
```

## ğŸ¯ í•µì‹¬ ê°œë…: ë²„í‚· ì •ë ¬ì˜ ì¤‘ìš”ì„±

ì´ íŠœí† ë¦¬ì–¼ì˜ ê°€ì¥ ì¤‘ìš”í•œ ê°œë…ì€ **ë²„í‚· ì •ë ¬(Bucket Alignment)**ì…ë‹ˆë‹¤.

### ë¬¸ì œ ì´í•´

`.sprints/sli-slo-sla-metrics-enhancement-plan.md`ì—ì„œ ì–¸ê¸‰ëœ ë‹¤ìŒ ë¬¸ì¥ë“¤ì„ ì´í•´í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤:

- âœ… **P95/P99 ê³„ì‚° ì •í™•ë„ í–¥ìƒ**
- âœ… **SLO ì„ê³„ê°’(ì˜ˆ: 500ms) ì •í™•íˆ ì¸¡ì • ê°€ëŠ¥**

### ì™œ ì¤‘ìš”í•œê°€?

Histogramì€ ë²„í‚·(bucket) ë‹¨ìœ„ë¡œ ê°’ì„ ì§‘ê³„í•©ë‹ˆë‹¤. ë²„í‚· ê²½ê³„ ìœ„ì¹˜ê°€ ì¸¡ì • ì •í™•ë„ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.

**ë‚˜ìœ ì˜ˆ:**
- ë²„í‚·: `[0, 1, 2, 5, 10]`ì´ˆ
- SLO ì„ê³„ê°’: 500ms (0.5ì´ˆ)
- ë¬¸ì œ: 500msê°€ ë²„í‚· ê²½ê³„ì— ì—†ì–´ì„œ ë¶€ì •í™•í•œ ì¸¡ì •

**ì¢‹ì€ ì˜ˆ:**
- ë²„í‚·: `[0.001, 0.005, 0.01, ..., 0.5, 1, ...]`ì´ˆ
- SLO ì„ê³„ê°’: 500ms (0.5ì´ˆ)
- ì¥ì : 0.5ì´ˆê°€ ë²„í‚· ê²½ê³„ì— ìˆì–´ ì •í™•í•œ ì¸¡ì • ê°€ëŠ¥

### Functoriumì˜ ì ‘ê·¼

Functoriumì˜ `DefaultHistogramBuckets`ëŠ” ì£¼ìš” SLO ì„ê³„ê°’ì„ ë²„í‚· ê²½ê³„ë¡œ í¬í•¨í•©ë‹ˆë‹¤:

- `0.5ì´ˆ (500ms)` = Command SLO P95 ëª©í‘œê°’
- `1ì´ˆ (1000ms)` = Command SLO P99 ëª©í‘œê°’
- `0.2ì´ˆ (200ms)` = Query SLO P95 ëª©í‘œê°’
- `0.5ì´ˆ (500ms)` = Query SLO P99 ëª©í‘œê°’

ì´ë ‡ê²Œ í•˜ë©´ SLO ìœ„ë°˜ ì—¬ë¶€ë¥¼ ì •í™•í•˜ê²Œ íŒë‹¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
HistogramExploration/
â”œâ”€â”€ Src/
â”‚   â””â”€â”€ HistogramExploration.Demo/
â”‚       â”œâ”€â”€ Program.cs                    # ë©”ì¸ ì§„ì…ì 
â”‚       â”œâ”€â”€ Basic/                        # ì´ˆë³´ì ë ˆë²¨
â”‚       â”‚   â”œâ”€â”€ Basic01_SimpleHistogram.cs
â”‚       â”‚   â”œâ”€â”€ Basic02_HistogramWithTags.cs
â”‚       â”‚   â””â”€â”€ Basic03_HistogramUnits.cs
â”‚       â”œâ”€â”€ Intermediate/                 # ì¤‘ê¸‰ ë ˆë²¨
â”‚       â”‚   â”œâ”€â”€ Intermediate01_CustomBuckets.cs
â”‚       â”‚   â”œâ”€â”€ Intermediate02_MultipleHistograms.cs
â”‚       â”‚   â””â”€â”€ Intermediate03_TagCombinations.cs
â”‚       â”œâ”€â”€ Advanced/                      # ê³ ê¸‰ ë ˆë²¨
â”‚       â”‚   â”œâ”€â”€ Advanced01_InstrumentAdvice.cs
â”‚       â”‚   â”œâ”€â”€ Advanced02_SloAlignedBuckets.cs
â”‚       â”‚   â”œâ”€â”€ Advanced03_RequestLatencyScenario.cs
â”‚       â”‚   â”œâ”€â”€ Advanced04_DatabaseQueryScenario.cs
â”‚       â”‚   â”œâ”€â”€ Advanced05_OrderProcessingScenario.cs
â”‚       â”‚   â””â”€â”€ Advanced06_BucketAlignmentImpact.cs â­
â”‚       â””â”€â”€ Shared/
â”‚           â”œâ”€â”€ ScenarioHelpers.cs
â”‚           â””â”€â”€ MetricViewer.cs
â””â”€â”€ README.md
```

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í”„ë¡œì íŠ¸ ë¹Œë“œ

```bash
cd Tutorials/HistogramExploration/Src/HistogramExploration.Demo
dotnet build
```

### 2. ì˜ˆì œ ì‹¤í–‰

**ëŒ€í™”í˜• ë©”ë‰´:**
```bash
dotnet run
```

**íŠ¹ì • ì˜ˆì œ ì§ì ‘ ì‹¤í–‰:**
```bash
dotnet run -- 4   # Basic04 (ë°±ë¶„ìœ„ìˆ˜ ì´í•´) ì‹¤í–‰
dotnet run -- 13  # Advanced06 ì‹¤í–‰
```

### 3. ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§ (ì„ íƒì‚¬í•­)

ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ `dotnet-counters`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”íŠ¸ë¦­ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# dotnet-counters ì„¤ì¹˜ (í•œ ë²ˆë§Œ)
dotnet tool update -g dotnet-counters

# ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§
dotnet-counters monitor -n HistogramExploration.Demo --counters HistogramExploration.*
```

## ğŸ“– ì˜ˆì œ ì„¤ëª…

### Basic Level

#### Basic01: Simple Histogram
- ê°€ì¥ ê¸°ë³¸ì ì¸ Histogram ìƒì„± ë° ê¸°ë¡
- `CreateHistogram<double>()` ì‚¬ìš©
- `Record()` ë©”ì„œë“œë¡œ ê°’ ê¸°ë¡

#### Basic02: Histogram with Tags
- íƒœê·¸ë¥¼ ì‚¬ìš©í•œ ë‹¤ì°¨ì› ë©”íŠ¸ë¦­
- `TagList` ì‚¬ìš© (Functorium íŒ¨í„´)
- ìƒ‰ìƒ, í¬ê¸° ë“±ìœ¼ë¡œ ë¶„ë¥˜ëœ ì¸¡ì •ê°’ ì˜ˆì œ

#### Basic03: Histogram Units
- ë‹¨ìœ„(unit) ì§€ì • ë°©ë²•
- UCUM í‘œì¤€ ì¤€ìˆ˜
- ì„¤ëª…(description) ì¶”ê°€

#### Basic04: Understanding Percentiles â­
- ë°±ë¶„ìœ„ìˆ˜(Percentile) ê°œë… ì´í•´
- P50, P90, P95, P99ì˜ ì˜ë¯¸
- Histogramê³¼ ë°±ë¶„ìœ„ìˆ˜ì˜ ê´€ê³„
- ì‹¤ì œ ë°ì´í„°ë¡œ ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚° ë° í•´ì„
- SLO ì„¤ì •ì—ì„œì˜ í™œìš©

### Intermediate Level

#### Intermediate01: Custom Buckets
- ì»¤ìŠ¤í…€ ë²„í‚· ê²½ê³„ ì„¤ì •
- `InstrumentAdvice` API ì‚¬ìš©
- ë²„í‚· ì„ íƒ ì „ëµ ì„¤ëª…

#### Intermediate02: Multiple Histograms
- ì—¬ëŸ¬ Histogram ë™ì‹œ ì‚¬ìš©
- Meterë³„ ê·¸ë£¹í™”
- ì¹´í…Œê³ ë¦¬ë³„ ë©”íŠ¸ë¦­ ê´€ë¦¬ (OpenTelemetryMetricRecorder íŒ¨í„´)

#### Intermediate03: Tag Combinations
- ë³µì¡í•œ íƒœê·¸ ì¡°í•©
- íƒœê·¸ ì¹´ë””ë„ë¦¬í‹° ì£¼ì˜ì‚¬í•­
- ë©”ëª¨ë¦¬ ìµœì í™” íŒ

### Advanced Level

#### Advanced01: InstrumentAdvice API
- `InstrumentAdvice<T>` API ìƒì„¸ ì„¤ëª…
- ê¶Œì¥ ë²„í‚· ê²½ê³„ ì„¤ì •
- OpenTelemetry SDK í†µí•©

#### Advanced02: SLO-Aligned Buckets
- SloConfiguration.DefaultHistogramBuckets ì‚¬ìš©
- SLO ëª©í‘œê°’ê³¼ ë²„í‚· ì •ë ¬
- ë°±ë¶„ìœ„ìˆ˜ ê³„ì‚° ì •í™•ë„ í–¥ìƒ

#### Advanced03: Request Latency Scenario
- HTTP ìš”ì²­ ì§€ì—°ì‹œê°„ ì¸¡ì • ì‹œë‚˜ë¦¬ì˜¤
- ì‹¤ì œ ì›¹ API íŒ¨í„´ ì‹œë®¬ë ˆì´ì…˜
- P95, P99 ë°±ë¶„ìœ„ìˆ˜ ë¶„ì„

#### Advanced04: Database Query Scenario
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‹¤í–‰ì‹œê°„ ì¸¡ì •
- ì¿¼ë¦¬ íƒ€ì…ë³„ ë¶„ë¥˜ (SELECT, INSERT, UPDATE)
- ëŠë¦° ì¿¼ë¦¬ ê°ì§€

#### Advanced05: Order Processing Scenario
- ì£¼ë¬¸ ì²˜ë¦¬ ì‹œê°„ ì¸¡ì • (SLO ì •ë ¬)
- Functoriumì˜ UsecaseMetricsPipeline íŒ¨í„´ ì ìš©
- SLO ìœ„ë°˜ ê°ì§€ ë° ì•Œë¦¼

#### Advanced06: Bucket Alignment Impact â­
**ì´ ì˜ˆì œê°€ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤!**

- **í•µì‹¬ ê°œë…**: "P95/P99 ê³„ì‚° ì •í™•ë„ í–¥ìƒ"ê³¼ "SLO ì„ê³„ê°’ ì •í™•íˆ ì¸¡ì • ê°€ëŠ¥" ì„¤ëª…
- ë¬¸ì œ ìƒí™© ì‹œë®¬ë ˆì´ì…˜:
  - ì‹œë‚˜ë¦¬ì˜¤: 100ê°œì˜ ìš”ì²­ ì²˜ë¦¬ ì‹œê°„ ì¸¡ì • (ëŒ€ë¶€ë¶„ 450-550ms ë²”ìœ„)
  - SLO ëª©í‘œ: P95 â‰¤ 500ms
  - ë‚˜ìœ ë²„í‚·: `[0, 1, 2, 5, 10]`ì´ˆ â†’ 500msê°€ ë²„í‚· ê²½ê³„ì— ì—†ì–´ ë¶€ì •í™•í•œ P95 ê³„ì‚°
  - ì¢‹ì€ ë²„í‚·: `[..., 0.25, 0.5, 1, ...]`ì´ˆ â†’ 0.5ì´ˆ(500ms)ê°€ ë²„í‚· ê²½ê³„ì— ìˆì–´ ì •í™•í•œ P95 ê³„ì‚°
- ì‹¤ì œ ì¸¡ì •ê°’ìœ¼ë¡œ ë¹„êµ:
  - ê°™ì€ ë°ì´í„°ì…‹ìœ¼ë¡œ ë‘ ê°€ì§€ ë²„í‚· ì„¤ì •ìœ¼ë¡œ ì¸¡ì •
  - P95/P99 ê°’ì˜ ì°¨ì´ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì¤Œ
  - ë²„í‚· ë¶„í¬ íˆìŠ¤í† ê·¸ë¨ ì¶œë ¥ìœ¼ë¡œ ì°¨ì´ ëª…í™•íˆ í‘œì‹œ

## ğŸ”— ì°¸ê³  ìë£Œ

### Microsoft Learn ë¬¸ì„œ
- [Creating Metrics - .NET | Microsoft Learn](https://learn.microsoft.com/en-us/dotnet/core/diagnostics/metrics-instrumentation)
- [System.Diagnostics.Metrics Namespace](https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.metrics)

### Functorium ì½”ë“œë² ì´ìŠ¤
- `Src/Functorium/Adapters/Observabilities/Metrics/OpenTelemetryMetricRecorder.cs`: Histogram ìƒì„± ë° ì‚¬ìš© íŒ¨í„´
- `Src/Functorium/Applications/Observabilities/SloConfiguration.cs`: DefaultHistogramBuckets ë° SLO ì •ë ¬ ë²„í‚· ì„¤ì •
- `Src/Functorium/Applications/Pipelines/UsecaseMetricsPipeline.cs`: ì‹¤ì œ í”„ë¡œë•ì…˜ ì‚¬ìš© ì˜ˆì œ

### ê´€ë ¨ ë¬¸ì„œ
- `.sprints/sli-slo-sla-metrics-enhancement-plan.md`: SLO/SLI/SLA ë©”íŠ¸ë¦­ ê°œì„  ê³„íš
- OpenTelemetry Histogram ë¬¸ì„œ

## ğŸ’¡ ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸

1. **Histogram ê¸°ë³¸ ê°œë…**: ë¶„í¬ ì¸¡ì •, ë°±ë¶„ìœ„ìˆ˜
2. **ë²„í‚· ì „ëµ**: ê¸°ë³¸ ë²„í‚· vs ì»¤ìŠ¤í…€ ë²„í‚·
3. **SLO ì •ë ¬**: ëª©í‘œê°’ê³¼ ë²„í‚· ê²½ê³„ ì •ë ¬ì˜ ì¤‘ìš”ì„±
   - **í•µì‹¬ ì´í•´**: ë²„í‚· ê²½ê³„ê°€ SLO ì„ê³„ê°’ê³¼ ì •ë ¬ë˜ì–´ì•¼ P95/P99 ê³„ì‚°ì´ ì •í™•í•´ì§
   - **ì˜ˆì‹œ**: SLOê°€ 500msì¸ë° ë²„í‚·ì´ [0, 1, 2, 5]ì´ˆë¡œ ì„¤ì •ë˜ë©´ 500ms ê·¼ì²˜ ê°’ë“¤ì´ ë¶€ì •í™•í•˜ê²Œ ì¸¡ì •ë¨
   - **í•´ê²°**: ë²„í‚·ì— 0.5ì´ˆ(500ms) ê²½ê³„ë¥¼ í¬í•¨í•˜ë©´ í•´ë‹¹ ì„ê³„ê°’ì„ ì •í™•íˆ ì¸¡ì • ê°€ëŠ¥
4. **ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­**: ë©”ëª¨ë¦¬ ì‚¬ìš©, íƒœê·¸ ì¹´ë””ë„ë¦¬í‹°
5. **ì‹¤ì „ ì ìš©**: ì‹¤ì œ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œì˜ í™œìš© ë°©ë²•

## ğŸ› ï¸ ìš”êµ¬ì‚¬í•­

- .NET 10.0 SDK
- System.Diagnostics.DiagnosticSource íŒ¨í‚¤ì§€ (ìë™ í¬í•¨)
- Functorium í”„ë¡œì íŠ¸ ì°¸ì¡° (SloConfiguration ì‚¬ìš©)

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ íŠœí† ë¦¬ì–¼ì€ Functorium í”„ë¡œì íŠ¸ì˜ ì¼ë¶€ì…ë‹ˆë‹¤.
